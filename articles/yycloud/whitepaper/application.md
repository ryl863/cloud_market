# 应用安全
应用安全是保障云应用使用的整个生命周期过程中所有过程和结果的安全。 用友云提供全面的应用安全保障，包括用友云使用安全开发流程保障应用开发生命周期安全，通过安全性评估过程保障业务流程安全。用友云提供的应用安全服务包括身份管理和访问控制、日志和监控、 应用安全管理、资源控制，以此达到应用本身的安全，同时支撑企业安全运维管理的需求。
## 安全开发生命周期
在安全开发流程上，引入了SDL，借鉴了微软推广SDL的经验，并结合企业级安全需求以及用友云自身的项目开发流程，控制项目整体的安全风险。 SDL 如下：

用友云应用开发安全过程保证

![](/articles/yycloud/whitepaper/images/image4.png)

 
资料来源：用友云，2017

安全开发流程参照软件安全开发周期（ Security Development Lifecycle）建立：

（1）安全需求分析环节：根据功能需求文档进行安全需求分析，针对业务内容、业务流程、技术框架进行沟通，形成《安全需求分析建议》进行审计备案。 

（2）安全设计环节：根据项目特征，与测试人员沟通安全测试关键点，形成 《安全测试建议》《质量目标》进行审计备案。 

（3）安全开发环节：整合 OWASP 指南、CERT 安全编码等材料，编制各类编程语言的安全编码规范，避免开发人员写出不安全的代码；使用开发代码扫描工具fortify并结合人工审核代码漏洞，对产品代码进行白盒、黑盒扫描。

（4）系统发布环节：安全部门依据上述环节评价结果决定代码是否发布。 服务器资产梳理，形成《服务器资产清单》备案 。对用友云线上环境进行安全漏洞评估，使用绿盟极光远程安全评估系统扫描漏洞，形成《安全漏洞扫描记录》备案。对用友云线上环境进行安全配置评估，形成《安全配置检查记录》备案 。

## 安全开发组件
用友云安全在开发组件上提供了丰富的安全组件选择和支持，在框架上要求应用选择工业级别的安全框架，如Spring-security、shiro等；在认证和授权上遵循OATH2规范，单点登陆的最佳实践框架采用CAS；用友云的安全日志组件，集中了安全日志事件，可监控可审计，并在敏感信息上过滤脱敏，去除用户的日志安全顾虑；数据加密组件采用符合国家标准的安全加密算法，用户数据的保密性得到有效保障等。
## 日志和监控
用友云提供上机日志、 业务日志和安全日志，通过日志对各个模块的运行情况和用户关键操作进行监控并跟踪记录。UAP 日志遵循 W7 原则，即记录谁、在什么时候、从什么地方、在什么地方、对什么对象做了什么事情、事情的结果是什么。
### 上机日志
上机日志通过系统管理日志（ system 的上机日志）、集团管理日志（集团管理员的上机日志）、普通业务日志（其他用户的上机日志）来分别记录用户进入或退出的某个功能节点及其时间。系统管理日志和集团管理日志是关键用户日志。
### 业务日志
业务日志记录用户对业务数据的有效操作内容。业务日志的记录配置支持记录到业务对象的操作和属性级，可以通过配置把敏感的业务对象的哪些操作和哪些属性记录业务日志，业务日志会记录这些属性的变化。对重要的业务对象，系统预置为必须记录业务日志，不可配置为不记录业务日志。
### 安全日志
安全日志记录发生了哪些与安全有关的活动，谁对这个活动负责。安全日志的目的是追踪和记录发生在涉及安全对象上的事件。 安全日志关注包括身份认证、登录，权限相关（权限管理、授权、权限访问控制）、访问控制、特权用户操作、安全配置变更、对关键功能的访问等等。安全日志作为 UAP 系统关键日志默认打开并且不可关闭。
### 安全事件监控和响应支持
安全事件监控主要包括安全事件的收集、安全事件的归并和过滤、安全事件标准化、安全事件显示和报表。通过安全事件监控可以帮助企业积极监控整个组织内的 IT 资源，过滤并关联事件，迅速定位安全威胁，并为安全事件响应提供支持。用友云提供灵活可扩展的安全事件监控机制，提供包括用户认证异常、权限异常、权限变更、特权用户操作等等安全事件监控。相应的，用友云提供灵活可扩展的安全事件自动响应处理机制，提供发送警告、通知外部安全事件处理系统、邮件、短信等自动响应，提供统一的服务拒绝处理，供事件响应处理调用，如按用户拒绝、按 IP 拒绝、按服务拒绝等，提供安全事件处理方法。同时对第三方安全信息与事件管理系统（SIEM）的提供支持。
### 对审计的支持
用友云通过记录系统各个层次发生的事情， 保留审计线索。通过审计工具能够进行各种系统审计、业务审计、 IT 审计等等，满足企业内控要求。通过安全审计达到对潜在的攻击者起到震慑和警告的作用，对于已发生的系统破坏行为提供有效的追责的证据，为系统管理员提供有价值的系统使用日志，帮助其发现系统入侵行为或潜在的系统漏洞的目的。
## Web应用安全
### 会话安全
会话安全采取如下措施：

• 在每次认证后打开一个新的会话： 即使已经有与用户关联的会话标示符，在用户认证成功之后仍要重新建立一个会话。

• 强制执行一个会话最大空闲时间： 用于缩短那些未能及时注销的用户暴露在外的时间， 减少了可供攻击者猜解的会话ID的平均数目。

• 强制执行一个会话最大生存周期： 增加安全性和稳定性。只有在不超过会话 ID最大生存周期的时候，才允许一个会话不用再次进行对用户的认证。通过进行重新认证，可以防止攻击者窃取会话 ID。

### API的服务认证
用友云服务会对每个访问的请求进行身份验证，所以无论使用 HTTP 还是 HTTPS 协议提交请求，都需要在请求中包含签名（Signature）信息。通过使用Access Key ID和Access Key Secret进行对称加密的方法来验证请求的发送者身份。Access Key ID和Access Key Secret由用友云官方颁发给访问者（可以通过用友云官方网站申请和管理），其中Access Key ID用于标识访问者的身份；Access Key Secret 是用于加密签名字符串和服务器端验证签名字符串的密钥，必须严格保密，只有用友云和用户知道。

用友云服务认证

![](/articles/yycloud/whitepaper/images/image5.png)

 
资料来源：用友云，2017
### Web应用防火墙
用友云通过阿里云应用防火墙WAF防御SQL注入、XSS跨站脚本、常见Web服务器插件漏洞、木马上传、非授权核心资源访问等OWASP常见攻击，过滤海量恶意CC攻击，避免您的网站资产数据泄露，保障网站的安全与可用性。
 
用友云Web应用防火墙

![](/articles/yycloud/whitepaper/images/image6.png)

 
资料来源：用友云，阿里云，2017
## 企业通讯录安全
企业通信录采用加密存储， 可分级管理通信录，针对不同人群设置不同权限； 同时企业可以设置对重要部门进行保护， 该部门的信息会自动隐藏， 即使是企业内的员工，没有相应权限无法访问。
对于不同公司的信息， 存储空间是相互隔离的，当员工离职后，会被踢出对应的企业群， 自动剥离员工在该企业的权限。
企业可以设置对员工的手机号进行隐私保护， 在对外展示员工信息时隐藏手机号码，防止信息泄露，但不影响电话通讯和电话会议等相关功能的使用。
## 电子邮件与短信安全
用友云服务中大量使用到了电子邮箱和短信等服务。用友提供的电子邮箱服务如微邮，结合大数据的技术，能够对垃圾邮件数据进行了有效的清洗，保障用户邮箱不受侵扰和攻击。通过用友云提供的服务在客户端存储是加密保密的，用友云服务发出的邮箱和短信，对链接的使用非常谨慎，防止盗链、跨站攻击的出现。
